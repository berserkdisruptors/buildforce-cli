id: standardize-yaml-extensions-20251103000000
name: "Standardize YAML File Extensions to .yaml"
type: feature
status: draft
created: "2025-11-03"
last_updated: "2025-11-03"

summary: |
  Standardize all YAML file extensions across the buildforce-cli codebase to use .yaml exclusively,
  eliminating the current .yaml/.yaml inconsistency that causes file-not-found errors for AI agents.

# INTENT / PROBLEM STATEMENT

problem: |
  The codebase currently has mixed usage of .yaml and .yaml file extensions, creating inconsistencies that lead to
  file-not-found errors when AI agents attempt to read spec, plan, research, or context files. Command templates
  reference .yaml in some places and .yaml in others, while actual template files use both extensions. This
  ambiguity causes workflow failures and confusion for developers and AI agents alike.

motivation: |
  A single, consistent file extension standard eliminates confusion, prevents file-not-found errors, improves
  developer experience, and aligns with modern YAML conventions. Since spec and plan templates already use .yaml,
  standardizing on this extension provides the path of least resistance while matching industry trends toward
  the more explicit .yaml format.

# GOALS

primary_goals:
  - Eliminate all .yaml file extensions in favor of .yaml across the entire codebase
  - Update all references in command templates, documentation, and source files to use .yaml consistently
  - Ensure AI agents can reliably locate and read all YAML files without extension ambiguity
  - Establish .yaml as the single, documented standard for all future YAML files

secondary_goals:
  - Preserve file history through git-based renames
  - Minimize breaking changes through phased migration approach
  - Update documentation to reflect the single-extension standard
  - Validate consistency through grep tests

# REQUIREMENTS

functional_requirements:
  - FR1: Rename src/templates/research-template.yaml to research-template.yaml
  - FR2: Rename src/context/_index.yaml to _index.yaml
  - FR3: Rename src/context/_schema.yaml to _schema.yaml
  - FR4: Rename src/context/_graph.yaml to _graph.yaml
  - FR5: Update all .yaml references to .yaml in src/templates/commands/build.md (10+ references)
  - FR6: Update all .yaml references to .yaml in src/templates/commands/complete.md (8+ references)
  - FR7: Update all .yaml references to .yaml in src/templates/commands/spec.md (12+ references)
  - FR8: Update all .yaml references to .yaml in src/templates/commands/research.md (3+ references)
  - FR9: Update all .yaml references to .yaml in src/templates/commands/document.md (3+ references)
  - FR10: Update all research.yaml references to research.yaml in README.md (5+ references)
  - FR11: Update self-references within research-template.yaml after rename
  - FR12: Update context index documentation to reference .yaml extension instead of .yaml
  - FR13: Migrate existing .buildforce/context/_index.yaml to _index.yaml (Phase 2)
  - FR14: Migrate existing .buildforce/context/_schema.yaml to _schema.yaml (Phase 2)
  - FR15: Migrate existing .buildforce/context/_graph.yaml to _graph.yaml (Phase 2)

non_functional_requirements:
  - NFR1: All file renames must use git mv to preserve file history
  - NFR2: Changes must be validated with grep to ensure no .yaml references remain in updated files
  - NFR3: Implementation must be atomic within each phase to allow rollback if needed
  - NFR4: Documentation must be updated concurrently with code changes
  - NFR5: Zero tolerance for mixed extensions - all YAML files must use .yaml after migration

# SCOPE

in_scope:
  - Renaming 4 source template/context files from .yaml to .yaml
  - Updating 40+ references across 7 files (5 command templates + README + research-template itself)
  - Updating context index documentation to specify .yaml extension requirement
  - Migrating 3 existing .buildforce context files to .yaml (Phase 2)
  - Validating consistency through automated grep tests
  - Updating distributed templates via buildforce init workflow

out_of_scope:
  - Changes to shell scripts (already use .yaml correctly)
  - Changes to CHANGELOG.md (already uses .yaml correctly)
  - Backward compatibility support for .yaml extensions (clean break)
  - Migration of user's existing spec folders (users handle their own specs)
  - Changes to external dependencies or third-party tools

# DESIGN PRINCIPLES

design_principles:
  - "Single source of truth: .yaml is the only valid YAML extension"
  - "Explicit over implicit: .yaml is more recognizable than .yaml"
  - "Consistency over convenience: No exceptions to the .yaml rule"
  - "History preservation: Use git mv for all renames"
  - "Phased approach: Separate source fixes from instance migrations"

# ACCEPTANCE CRITERIA

acceptance_criteria:
  - AC1: All 4 source files renamed from .yaml to .yaml with git history preserved
  - AC2: grep '.yaml' src/templates/commands/ returns zero matches
  - AC3: grep 'research\.yaml' README.md returns zero matches
  - AC4: grep '\.yaml' src/context/_index.yaml returns zero matches in documentation
  - AC5: All command templates successfully reference research-template.yaml
  - AC6: buildforce init creates .buildforce/templates/ with all .yaml files
  - AC7: Context system documentation explicitly states ".yaml extension" requirement
  - AC8: All existing .buildforce context files migrated to .yaml (Phase 2)
  - AC9: No mixed extensions exist anywhere in src/ or .buildforce/ directories
  - AC10: CLI rebuild succeeds and distributes updated .yaml templates

# ASSUMPTIONS & DEPENDENCIES

assumptions:
  - Existing in-progress specs may break and require manual migration by users
  - .buildforce/templates/ will be regenerated during initialization
  - No external tools depend on the .yaml extension specifically
  - Git is available for file renames
  - TypeScript compilation works identically with either extension

dependencies:
  internal:
    - buildforce-init: "Distributes updated templates to .buildforce/templates/"
    - command-templates: "Core slash commands that reference YAML files"
    - context-system: "Context file schema and indexing"
  external:
    - git: "Required for git mv operations to preserve history"

# OPEN QUESTIONS

open_questions:
  - RESOLVED: No migration script needed - provide manual instructions in CHANGELOG.md only
  - RESOLVED: Phase 2 is only for buildforce-cli repo itself, not external users (no one using tool yet)
  - RESOLVED: No validation needed in buildforce init - still iterating locally

# NOTES

notes: |
  Phase 2 migration applies only to the buildforce-cli repository's own .buildforce/ directory, not external users
  (since no one is using the tool yet). This is a local-only migration for the project's own context files.

  No migration script or automated tooling needed - this is a one-time manual fix for the current repo.
  Phase 1 establishes the .yaml standard in source templates for future distribution.

  The research revealed that bash and PowerShell scripts already use .yaml correctly, so no script changes are
  needed. This suggests the inconsistency was introduced gradually rather than being a systematic decision.

  Future consideration: Add linter rule to prevent .yaml files from being committed to src/ directory.
