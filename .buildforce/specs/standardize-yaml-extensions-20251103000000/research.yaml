id: "standardize-yaml-extensions-20251103000000-research"
created: "2025-11-03"
last_updated: "2025-11-03"

summary: |
  Comprehensive investigation of .yaml vs .yml file extension inconsistencies across the buildforce-cli codebase.
  Analysis reveals mixed usage that causes file-not-found errors when AI agents attempt to read workflow and context files.
  Strategy decision: Standardize on .yaml extension for ALL YAML files - no exceptions, maximum consistency.

key_findings:
  - "Current state has 2 template files using .yaml (spec, plan) and 4 files using .yml (research template, context system files)"
  - "Command templates contain 40+ inconsistent references mixing .yml and .yaml extensions"
  - "Shell scripts already use .yaml correctly - no script changes needed"
  - "File renames are breaking changes affecting initialization and in-progress specs"
  - "Two-phase migration required: Phase 1 fixes source templates/commands, Phase 2 migrates .buildforce/ generated files"

file_paths:
  primary:
    - path: "src/templates/research-template.yml"
      relevance: "Must rename to .yaml - template file inconsistency"
    - path: "src/context/_index.yml"
      relevance: "Must rename to .yaml - context system file"
    - path: "src/context/_schema.yml"
      relevance: "Must rename to .yaml - context system file"
    - path: "src/context/_graph.yml"
      relevance: "Must rename to .yaml - context system file"

  secondary:
    - path: "src/templates/commands/build.md"
      relevance: "Contains 10+ .yml references to update"
    - path: "src/templates/commands/complete.md"
      relevance: "Contains 8+ .yml references to update"
    - path: "src/templates/commands/spec.md"
      relevance: "Contains 12+ .yml references to update"
    - path: "src/templates/commands/research.md"
      relevance: "Contains 3+ .yml references to update"
    - path: "src/templates/commands/document.md"
      relevance: "Contains 3+ .yml references to update"
    - path: "README.md"
      relevance: "Contains 5+ research.yml references to update"
    - path: "src/scripts/bash/create-spec-files.sh"
      relevance: "Already correct - uses .yaml"
    - path: "src/scripts/powershell/create-spec-files.ps1"
      relevance: "Already correct - uses .yaml"

mermaid_diagrams:
  - title: "Current File Extension Architecture Flow"
    description: "Shows how command templates, scripts, and generated files interact with mixed .yaml/.yml extensions"
    diagram: |
      ```mermaid
      graph TB
          subgraph "Command Templates"
              RESEARCH[/research command]
              SPEC[/spec command]
              BUILD[/build command]
              COMPLETE[/complete command]
              DOCUMENT[/document command]
          end
          
          subgraph "Scripts"
              CREATE_BASH[create-spec-files.sh]
              CREATE_PS1[create-spec-files.ps1]
              GET_PATHS[get-spec-paths.sh]
          end
          
          subgraph "Template Files src/templates/"
              SPEC_TPL[spec-template.yaml ✓]
              PLAN_TPL[plan-template.yaml ✓]
              RESEARCH_TPL[research-template.yml ❌<br/>→ .yaml]
          end
          
          subgraph "Context System src/context/"
              INDEX_SRC[_index.yml ❌ → .yaml]
              SCHEMA_SRC[_schema.yml ❌ → .yaml]
              GRAPH_SRC[_graph.yml ❌ → .yaml]
          end
          
          subgraph "Generated Files .buildforce/"
              SPEC_GEN[spec.yaml ✓]
              PLAN_GEN[plan.yaml ✓]
              RESEARCH_GEN[research.yaml ✓]
              INDEX_GEN[_index.yaml ✓]
              SCHEMA_GEN[_schema.yaml ✓]
              GRAPH_GEN[_graph.yaml ✓]
              CONTEXT_GEN[context/*.yaml ✓]
          end
          
          SPEC -->|creates| CREATE_BASH
          CREATE_BASH -->|copies| SPEC_TPL
          CREATE_BASH -->|copies| PLAN_TPL
          CREATE_BASH -->|generates| SPEC_GEN
          CREATE_BASH -->|generates| PLAN_GEN
          
          SPEC -->|materializes| RESEARCH_GEN
          RESEARCH -->|reads| INDEX_GEN
          
          BUILD -->|reads| SPEC_GEN
          BUILD -->|reads| PLAN_GEN
          BUILD -->|reads| RESEARCH_GEN
          
          COMPLETE -->|reads| SPEC_GEN
          COMPLETE -->|reads| PLAN_GEN
          COMPLETE -->|creates/updates| CONTEXT_GEN
          COMPLETE -->|updates| INDEX_GEN
          
          DOCUMENT -->|reads| INDEX_GEN
          DOCUMENT -->|creates/updates| CONTEXT_GEN
          
          style RESEARCH_TPL fill:#ff6b6b
          style INDEX_SRC fill:#ff6b6b
          style SCHEMA_SRC fill:#ff6b6b
          style GRAPH_SRC fill:#ff6b6b
      ```

data_models:
  - name: "FileExtensionStrategy"
    description: "Single extension strategy for all YAML files"
    properties:
      - name: "targetExtension"
        type: "'.yaml'"
        required: true
        description: "Single extension to use across all YAML files"
      - name: "rationale"
        type: "string"
        required: true
        description: "Single extension eliminates confusion, improves consistency, aligns with modern standards"
      - name: "scope"
        type: "'all-yaml-files'"
        required: true
        description: "Apply to all YAML files without exception"

  - name: "FileRename"
    description: "Files that require renaming from .yml to .yaml"
    properties:
      - name: "currentPath"
        type: "string"
        required: true
        description: "Current file path with .yml extension"
      - name: "newPath"
        type: "string"
        required: true
        description: "Target file path with .yaml extension"
      - name: "category"
        type: "'template' | 'context-system'"
        required: true
        description: "Category of file being renamed"
    relationships:
      - "4 total files to rename: 1 template + 3 context system files"

  - name: "ChangeImpact"
    description: "Impact assessment for each file category"
    properties:
      - name: "fileCategory"
        type: "string"
        required: true
        description: "Category of files affected"
      - name: "filesAffected"
        type: "number"
        required: true
        description: "Count of files in this category"
      - name: "breakingChange"
        type: "boolean"
        required: true
        description: "Whether this change breaks existing functionality"
      - name: "migrationType"
        type: "'rename' | 'update-references' | 'both'"
        required: true
        description: "Type of migration required"
      - name: "effort"
        type: "'low' | 'medium' | 'high'"
        required: true
        description: "Estimated effort level"

architectural_decisions:
  - pattern: "Single Extension Standard"
    description: "Use .yaml for all YAML files across the entire codebase with no exceptions"
    rationale: "Eliminates confusion, prevents file-not-found errors, aligns with modern standards, and matches existing spec/plan template convention"

  - pattern: "Two-Phase Migration"
    description: "Phase 1: Fix source files (templates, commands, docs). Phase 2: Migrate .buildforce/ generated files"
    rationale: "Separates breaking changes in source templates from migration of user-generated specs, allows for testing between phases, and provides rollback points"

  - pattern: "Git-based File Renames"
    description: "Use git mv for all file renames to preserve history"
    rationale: "Maintains file history through rename, enables blame/log tracking, and avoids broken references in git history"

tldr:
  - "Single extension goal: Standardize ALL YAML files to .yaml - no exceptions, maximum consistency"
  - "4 files need rename: research-template.yml, _index.yml, _schema.yml, _graph.yml → all to .yaml"
  - "7 files need reference updates: 5 command templates + README.md + research-template self-references"
  - "40+ individual references to change: All .yml references changed to .yaml across documentation and commands"
  - "No script changes needed: Bash and PowerShell scripts already use .yaml correctly"
  - "Breaking change: File renames affect initialization and any in-progress specs using old context system"
  - "Rationale for .yaml: More explicit, modern standard, already used by primary workflow templates (spec/plan)"

