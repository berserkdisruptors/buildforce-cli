id: slash-commands-20250101120000
name: "Slash Commands for Spec-Driven Development Workflow"
type: feature
status: in-progress
created: "2025-01-15"
last_updated: "2025-01-15"

# INTENT / PROBLEM STATEMENT

problem: |
  Current AI-assisted software development has several pain points:
  - Build agents rush into implementation without proper planning
  - Users must repeatedly explain spec-driven development workflow every session
  - No time to properly plan solutions, consider edge cases, or decide on design patterns/libraries
  - Context window warmup is manual and time-consuming (pointing files with @, explaining architecture)
  - No mechanism to track deviations from original plan during implementation
  - No explicit confirmation stepimplementations often drift from original intent
  - Project knowledge is scattered and must be re-gathered in every session

motivation: |
  Enable a structured, repeatable spec-driven development workflow where:
  - Context is gathered efficiently from accumulated project knowledge
  - Intent is materialized into clear specifications before implementation
  - Plans are designed and agreed upon before coding begins
  - Implementation follows spec+plan with deviation tracking
  - Explicit completion confirmation ensures intent match

# GOALS

primary_goals:
  - Create 5 slash commands (RESEARCH, SPEC, PLAN, BUILD, COMPLETE) that guide build agents through spec-driven workflow
  - Implement project context repository (.buildforce/context) as primary knowledge source
  - Make commands compact but powerfulenhance queries without teaching HOW to work
  - Support iterative refinement at every stage (spec, plan, build)
  - Enable deviation tracking during implementation
  - Provide explicit completion validation

secondary_goals:
  - Commands should be Claude Code compatible (use $ARGUMENTS)
  - Follow principles from @spec-kit but simplified to 5 commands
  - Produce structured outputs (reports, diagrams, file lists) for workflow continuity
  - Eliminate manual context gathering burden (@ file references, architecture explanations)

# WORKFLOW DESIGN

The 5-command lifecycle:

1_research:
  command: "/research <query>"
  purpose: "Gather context for spec-driven development session"
  innovation: "Searches .buildforce/context/_index.yaml FIRST for accumulated project knowledge"
  outputs:
    - Structured report (Research Summary, Project Context, Codebase Findings, External Knowledge)
    - Explicit file path lists (saves manual @ references)
    - Mermaid architecture diagrams (for codebase queries)
    - Concrete data models (not summaries)
  key_guidelines:
    - Project Context Search (ALWAYS start with _index.yaml)
    - Recency awareness (web search for current topics)
    - Structured output for next workflow steps

2_spec:
  command: "/spec <intent>"
  purpose: "Materialize user intent into specification (WHAT to build)"
  outputs:
    - Specification document with sections: Overview, Scope, Functional/Non-Functional Requirements, Edge Cases, Data Models, Assumptions, Open Questions
  key_behaviors:
    - Validates prerequisite context (suggests /research if needed)
    - Asks up to 3 clarifying questions if intent is vague
    - Ensures requirements are testable and measurable
    - Prevents premature HOW decisions (stays focused on WHAT)
    - Supports iteration until user confirms completeness

3_plan:
  command: "/plan [instructions]"
  purpose: "Design implementation approach (HOW to build)"
  prerequisites: "Requires prior /spec command"
  outputs:
    - Implementation plan with: Architecture Overview, Design Decisions, File Structure, Numbered Implementation Steps, Testing Plan, Risk & Considerations
  key_behaviors:
    - Justifies all technology/library choices with rationale
    - References specific file paths in steps
    - Validates plan aligns with ALL spec requirements
    - Supports iteration until user approves approach

4_build:
  command: "/build [instructions]"
  purpose: "Execute implementation following spec+plan with progress tracking"
  prerequisites: "Requires prior /spec and /plan commands"
  outputs:
    - Implementation (files created/modified)
    - Deviation log (changes from original plan with rationale)
    - Confirmation prompt for user
  key_behaviors:
    - Tracks progress step-by-step with visible checklist
    - Logs deviations (e.g., library swaps, plan changes)
    - Supports multiple iterations until satisfaction
    - Requests explicit confirmation before completion (never auto-completes)

5_complete:
  command: "/complete"
  purpose: "Finalize feature and validate intent match"
  prerequisites: "Requires prior /spec, /plan, and /build commands"
  outputs:
    - Completion report with: Feature summary, Requirements validation, Files modified, Deviation log, Testing status, Final validation checklist
  key_behaviors:
    - Validates ALL spec requirements implemented
    - Reviews deviation log across all /build iterations
    - Requires explicit user confirmation
    - Suggests next steps or improvements

# KEY INNOVATION: PROJECT CONTEXT REPOSITORY

context_repository:
  location: ".buildforce/context/"
  structure:
    - "_index.yaml: Searchable index with references to all context files"
    - "_schema.yaml: Schema guidelines for creating context files"
    - "_graph.mmd: Mermaid diagram showing architecture (constantly updated)"
    - "*.yaml: Individual context files (modules, features, components, patterns)"

  purpose: |
    Accumulated knowledge from all completed spec-driven development sessions.
    Organized by modules/components/features.
    Acts as primary source of truth about project architecture, patterns, and decisions.

  workflow_integration: |
    RESEARCH command ALWAYS searches _index.yaml first before any other research.
    Eliminates redundant codebase exploration by leveraging past sessions.
    Provides instant access to architecture, data models, design decisions, file paths.

# REQUIREMENTS

functional_requirements:
  - FR1: All 5 commands must be implementable as Claude Code slash commands (markdown files with $ARGUMENTS)
  - FR2: RESEARCH must search .buildforce/context/_index.yaml before any other research
  - FR3: RESEARCH must detect recency indicators and use web search appropriately
  - FR4: RESEARCH must produce structured reports with file lists, diagrams, data models
  - FR5: SPEC must validate context and ask clarifying questions if needed
  - FR6: SPEC must generate complete specification with all required sections
  - FR7: PLAN must require prior /spec command and validate alignment
  - FR8: PLAN must justify all design decisions with rationale
  - FR9: BUILD must track progress and log deviations from plan
  - FR10: BUILD must support multiple iterations with user feedback
  - FR11: COMPLETE must validate all spec requirements and review deviations
  - FR12: COMPLETE must require explicit user confirmation

non_functional_requirements:
  - NFR1: Commands must be compact (minimize verbosity while maintaining power)
  - NFR2: Commands must NOT teach build agents HOW to work (they already know)
  - NFR3: Commands must enhance user queries with workflow-specific context
  - NFR4: Outputs must be structured for easy reference in subsequent steps
  - NFR5: Workflow must support iteration at every stage

# DESIGN PRINCIPLES

principles:
  - "Compact but powerful: Enhance user queries without teaching build agents HOW to work"
  - "Context-first: Always search project context repository before other research"
  - "Incremental: Focus on single, focused changes, not complete rewrites"
  - "Traceable: Log deviations, track progress, validate against spec"
  - "Iterative: Support refinement at every stage (spec, plan, build)"
  - "Explicit: Require user confirmation at key decision points (plan approval, completion)"

# SCOPE

in_scope:
  - Create 5 command markdown files in src/templates/commands/
  - Implement RESEARCH command with 7 key guidelines
  - Implement SPEC command with intent materialization logic
  - Implement PLAN command with design decision framework
  - Implement BUILD command with progress tracking and deviation logging
  - Implement COMPLETE command with validation and confirmation
  - Create initial context repository structure (.buildforce/context/)
  - Create _index.yaml, _schema.yaml, _graph.mmd, slash-commands.yaml, research-slash-command.yaml

out_of_scope:
  - Actual CLI implementation that reads/executes these commands (future work)
  - Automatic context file generation from completed specs (future work)
  - Integration with git hooks or CI/CD (future work)
  - Multi-user collaboration features (future work)

# ACCEPTANCE CRITERIA

success_criteria:
  - AC1: All 5 command files exist in src/templates/commands/ with complete content
  - AC2: RESEARCH command can be tested by pasting into .claude/commands
  - AC3: Each command captures 100% of the manual workflow currently performed
  - AC4: Commands are compact (~20-40 lines each) but fully specified
  - AC5: Context repository structure is established with example files
  - AC6: _index.yaml properly references all context files
  - AC7: Manual testing confirms commands guide build agents correctly

# ASSUMPTIONS & DEPENDENCIES

assumptions:
  - Build agents (Claude, etc.) already know how to research, write specs, plan, and code
  - Commands will be used in Claude Code environment (supports $ARGUMENTS, markdown slash commands)
  - Users will iterate on commands until satisfied with capture of their workflow

dependencies:
  - Claude Code CLI for testing commands
  - .buildforce/ directory structure for context repository
  - Git repository for version control

# OPEN QUESTIONS

None at this time. Intent is clear and workflow is well-defined.

# NOTES

inspired_by: "@spec-kit workflow (6+ commands) but simplified to 5 commands"
key_differentiator: "Project context repository as primary knowledge source"
first_implementation: "RESEARCH command completed and iterated to 100% flow capture"
