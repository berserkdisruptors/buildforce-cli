# Buildforce Context Repository Index & Coverage Map
# This file serves as both the context index AND the context coverage map.
# Version 2.1: Unified structure with domain items tracking for /buildforce.extract

version: "2.1"

# ============================================================================
# CONTEXT TAXONOMY OVERVIEW
# ============================================================================
#
# The context repository is organized into three domains, each aligned with
# the context taxonomy pillars that AI agents need most:
#
# 1. ARCHITECTURE (architecture/)
#    Answers: WHAT exists already?
#    Contains: Structural understanding of modules, features, components, and their relationships
#    Used by: /buildforce.research, /buildforce.plan, /buildforce.build
#
# 2. CONVENTIONS (conventions/)
#    Answers: HOW do we do things here?
#    Contains: Coding standards, patterns, and practices
#    Used by: /buildforce.plan, /buildforce.build (validation)
#
# 3. VERIFICATION (verification/)
#    Answers: HOW do I know it's right?
#    Contains: Quality standards, test expectations, known risks
#    Used by: /buildforce.build (self-review), PR Review Actions
#
# For more details on the context taxonomy, see:
# https://buildforce.dev/concepts/context-taxonomy
#
# ============================================================================
# VERSION 2.1: COVERAGE MAP FUNCTIONALITY
# ============================================================================
#
# In v2.1, this file also serves as a coverage map for /buildforce.extract.
# Each domain tracks:
#   - items[]: Discovered and extracted context items with status/depth
#   - coverage: Percentage of items that have been extracted
#   - average_depth: Overall extraction depth (none|shallow|moderate|deep)
#
# Item structure:
#   - id: unique-item-id
#   - file: path/to/context-file.yaml
#   - type: structural|convention|verification
#   - description: Brief description of the item
#   - tags: [optional, categorization, tags]
#   - related_context: [references-to-other-items]
#   - status: discovered | in-progress | extracted
#   - depth: none | shallow | moderate | deep
#
# The /buildforce.extract command uses this coverage map to:
#   1. Track what has been discovered in the codebase
#   2. Track what has been extracted and to what depth
#   3. Recommend focus areas for subsequent extraction iterations
#
# ============================================================================

# Timestamps (populated by /buildforce.extract on first run)
generated_at: "2026-02-02"
last_updated: "2026-02-02"

# ============================================================================
# CODEBASE PROFILE
# ============================================================================
# Populated by /buildforce.extract during initial codebase scan.
# Provides high-level overview of the project for AI agents.

codebase_profile:
  languages: [typescript, bash, powershell]
  frameworks: [commander, inquirer]
  project_type: "cli tool"
  scale: "small (~5k LOC)"

# ============================================================================
# CONTEXT DOMAINS
# ============================================================================
# Each domain tracks both schema reference AND extracted items.
# Items are discovered during codebase scan and populated during extraction.

domains:
  architecture:
    description: |
      Structural context about WHAT exists in the codebase.
      Contains understanding of modules, features, components, and their relationships.
    schema: architecture/_schema.yaml
    coverage: 0
    average_depth: none
    items:
      - id: slash-commands
        file: architecture/slash-commands.yaml
        type: structural
        status: extracted
        depth: moderate
        description: Core slash command system enabling spec-driven development workflow for AI agents
        tags: [ core, workflow, agents ]
        related_context: [ research-slash-command, plan-command, build-command, complete-command, document-command, plan-template, cli-architecture ]

      - id: research-slash-command
        file: architecture/research-slash-command.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Slash command for gathering context from project knowledge, codebase, and external sources
        tags: [ core, workflow, research, context-gathering ]
        related_context: [ slash-commands, cli-architecture, document-command ]

      - id: build-command
        file: architecture/build-command.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Slash command for implementing features following spec and plan with progress tracking
        tags: [ slash-command, build, command-iteration, compression, workflow-enhancement, script-execution ]
        related_context: [ slash-commands, plan-template, plan-command ]

      - id: plan-template
        file: architecture/plan-template.yaml
        type: structural
        status: extracted
        depth: shallow
        description: YAML template structure for implementation plans with task tracking and validation
        tags: [ template, plan-template, build-agent, progress-tracking, checkbox-tracking, deviation-logging, spec-traceability, workflow-enhancement ]
        related_context: [ build-command, plan-command, slash-commands ]

      - id: document-command
        file: architecture/document-command.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Enhanced /document command with /complete UX patterns, empty context detection, and completion summaries
        tags: [ slash-command, document, context-creation, template-only, kebab-case-naming, intelligent-merge, auto-detection, workflow-utility, ux-enhancement ]
        related_context: [ slash-commands, complete-command, cli-architecture, research-slash-command ]

      - id: readme-documentation
        file: architecture/readme-documentation.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Primary documentation for Buildforce CLI covering installation, workflow, and contribution
        tags: [ documentation, readme, onboarding, spec-driven-development, philosophy, installation, quick-start, workflow, slash-commands, troubleshooting, contribution-guidelines, roadmap, changelog ]
        related_context: [ cli-architecture, slash-commands ]

      - id: plan-command
        file: architecture/plan-command.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Template-based /buildforce.plan command for creating/updating specifications and plans with state-based CREATE vs UPDATE logic
        tags: [ slash-command, plan, template-only, state-tracking, timestamp-naming, agent-driven, workflow-core ]
        related_context: [ slash-commands, plan-template, complete-command ]

      - id: complete-command
        file: architecture/complete-command.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Template-only /complete command for finalizing specs with agent-driven context file management
        tags: [ slash-command, complete, template-only, context-management, semantic-naming, intelligent-merge, workflow-core ]
        related_context: [ slash-commands, plan-command, document-command ]

      - id: upgrade-command
        file: architecture/upgrade-command.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Slash command for upgrading projects to latest templates while preserving user content
        tags: [ slash-command, upgrade, template-upgrade, preservation, dry-run, atomic-operations, backward-compatibility, workflow-utility ]
        related_context: [ slash-commands, cli-architecture, plan-command, complete-command, local-artifact-resolution ]

      - id: cli-architecture
        file: architecture/cli-architecture.yaml
        type: structural
        status: extracted
        depth: moderate
        description: Comprehensive CLI architecture with template distribution, context management, and multi-agent support
        tags: [ core, architecture, cli, commander, github-releases, context-system, agent-support, initialization, workflow-foundation ]
        related_context: [ slash-commands, document-command, research-slash-command, plan-command, plan-template, upgrade-command, local-artifact-resolution ]

      - id: research-persistence
        file: architecture/research-persistence.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Conversation-based research materialization system enabling structured research.yaml artifacts
        tags: [ research, persistence, materialization, conversation-based, workflow-enhancement, template-only ]
        related_context: [ research-slash-command, plan-command, build-command, complete-command ]

      - id: local-artifact-resolution
        file: architecture/local-artifact-resolution.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Local artifact resolution system for offline workflows and faster testing iterations
        tags: [ artifact-resolution, offline-support, local-development, testing, glob-pattern, workflow-utility ]
        related_context: [ cli-architecture, upgrade-command ]

      - id: examples-command
        file: architecture/examples-command.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Interactive CLI command for displaying workflow examples extracted dynamically from README.md
        tags: [ cli-command, workflow, examples, interactive, documentation, discoverability ]
        related_context: [ cli-architecture, readme-documentation ]

      - id: session-management-cli
        file: architecture/session-management-cli.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Interactive CLI command for managing and switching between active development sessions
        tags: [ cli-command, session-management, interactive, inquirer, workflow, state-tracking ]
        related_context: [ cli-architecture, state-tracking, plan-command ]

      - id: yaml-extension-standard
        file: architecture/yaml-extension-standard.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Codebase standard enforcing .yaml extension for all YAML files to eliminate inconsistency
        tags: [ pattern, standard, yaml, file-extensions, consistency, breaking-change, codebase-wide ]
        related_context: [ cli-architecture, plan-command, build-command, complete-command, document-command, research-slash-command ]

      - id: state-tracking
        file: architecture/state-tracking.yaml
        type: structural
        status: extracted
        depth: moderate
        description: JSON-based state tracking using buildforce.json to manage active spec sessions
        tags: [ core, state-management, buildforce-json, configuration, workflow-foundation ]
        related_context: [ plan-command, research-persistence, complete-command, cli-architecture ]

      - id: template-versioning
        file: architecture/template-versioning.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Automatic version injection for templates in release workflow with pre-commit strategy
        tags: [ release-workflow, templates, versioning, github-actions, automation, workflow-enhancement ]
        related_context: [ cli-architecture, plan-template, upgrade-command ]

      - id: commit-enforcement
        file: architecture/commit-enforcement.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Commit message and branch naming enforcement using commitlint, husky, and GitHub Actions
        tags: [ commit-enforcement, conventional-commits, commitlint, husky, commitizen, git-hooks, branch-naming, github-actions, contribution-standards, developer-experience ]
        related_context: [ readme-documentation, cli-architecture ]

      - id: command-naming-standard
        file: architecture/command-naming-standard.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Slash command naming convention using /buildforce.* prefix for namespace isolation
        tags: [ pattern, naming-convention, slash-commands, namespace-isolation, documentation-consistency ]
        related_context: [ slash-commands, readme-documentation, cli-architecture ]

      - id: extract-command
        file: architecture/extract-command.yaml
        type: structural
        status: extracted
        depth: moderate
        description: Claude Code-specific slash command for iterative context extraction from fresh codebases
        tags: [ slash-command, extract, context-mining, sub-agents, claude-code-only, coverage-map ]
        related_context: [ slash-commands, cli-architecture, upgrade-command ]

      - id: explore-command
        file: architecture/explore-command.yaml
        type: structural
        status: extracted
        depth: shallow
        description: Session-aware brainstorming command using Context Explorers for conversational context retrieval
        tags: [ slash-command, explore, context-retrieval, sub-agents, conversational, session-state ]
        related_context: [ slash-commands, extract-command, research-slash-command, cli-architecture ]

  conventions:
    description: |
      Convention context about HOW things are done here.
      Contains coding standards, architectural patterns, and project practices.
    schema: conventions/_schema.yaml
    coverage: 0
    average_depth: none
    items:
      - id: template-only-slash-commands
        file: conventions/template-only-slash-commands.yaml
        type: convention
        status: extracted
        depth: moderate
        description: Template-Only Slash Commands
        sub_type: architectural-pattern
        enforcement: strict

      - id: context-repository-pattern
        file: conventions/context-repository-pattern.yaml
        type: convention
        status: extracted
        depth: moderate
        description: Context Repository Pattern
        sub_type: architectural-pattern
        enforcement: recommended

      - id: bash-script-context-loading
        file: conventions/bash-script-context-loading.yaml
        type: convention
        status: extracted
        depth: shallow
        description: Bash Script Context Loading
        sub_type: code-convention
        enforcement: strict

      - id: error-handling-in-templates
        file: conventions/error-handling-in-templates.yaml
        type: convention
        status: extracted
        depth: shallow
        description: Error Handling in Templates
        sub_type: code-convention
        enforcement: recommended

      - id: manual-workflow-testing
        file: conventions/manual-workflow-testing.yaml
        type: convention
        status: extracted
        depth: shallow
        description: Manual Workflow Testing
        sub_type: testing-standard
        enforcement: recommended

      - id: template-only-changes-preferred
        file: conventions/template-only-changes-preferred.yaml
        type: convention
        status: extracted
        depth: shallow
        description: Template-Only Changes Preferred
        sub_type: dependency-rule
        enforcement: recommended

      - id: buildforcejson-replaces-current-spec
        file: conventions/buildforcejson-replaces-current-spec.yaml
        type: convention
        status: extracted
        depth: shallow
        description: buildforce.json replaces .current-spec
        sub_type: project-quirk
        enforcement: recommended

      - id: minimal-example-strategy
        file: conventions/minimal-example-strategy.yaml
        type: convention
        status: extracted
        depth: shallow
        description: Minimal Example Strategy
        sub_type: project-quirk
        enforcement: recommended

      - id: naming-conventions
        file: conventions/naming-conventions.yaml
        type: convention
        status: extracted
        depth: moderate
        description: Naming Conventions
        sub_type: naming-convention
        enforcement: recommended

      - id: yaml-file-extension-convention
        file: conventions/yaml-file-extension-convention.yaml
        type: convention
        status: extracted
        depth: shallow
        description: YAML File Extension Convention (.yaml not .yml)
        sub_type: code-convention
        enforcement: strict
        related_context: [ yaml-extension-standard ]

  verification:
    description: |
      Verification context about HOW to know if code is right.
      Contains quality standards, test expectations, review checklists, and known risks.
    schema: verification/_schema.yaml
    coverage: 100
    average_depth: shallow
    items:
      - id: testing-standards
        file: verification/testing-standards.yaml
        type: verification
        status: extracted
        depth: shallow
        description: Testing standards and expectations for the project
        source: extracted
        tags: [ testing, quality, verification ]

      - id: quality-gates
        file: verification/quality-gates.yaml
        type: verification
        status: extracted
        depth: shallow
        description: CI/CD quality gates and pre-commit requirements
        source: extracted
        tags: [ ci-cd, quality-gates, git-hooks, conventional-commits ]

      - id: review-criteria
        file: verification/review-criteria.yaml
        type: verification
        status: extracted
        depth: shallow
        description: PR review expectations and issue templates
        source: extracted
        tags: [ review, pr, issues, contribution ]

      - id: known-risks
        file: verification/known-risks.yaml
        type: verification
        status: extracted
        depth: shallow
        description: Known risks and areas requiring extra attention
        source: extracted
        tags: [ risks, gaps, testing, linting ]

      - id: local-testing-workflow
        file: verification/local-testing-workflow.yaml
        type: verification
        status: extracted
        depth: shallow
        description: Local testing workflow for template changes
        source: manual
        tags: [ testing, local, templates, verification, workflow ]
        related_context: [ local-artifact-resolution, cli-architecture, manual-workflow-testing ]

# ============================================================================
# AGGREGATE SUMMARY
# ============================================================================
# Computed metrics across all domains. Updated after each extraction iteration.

summary:
  overall_coverage: 100
  total_items: 36
  extracted_items: 36
  iterations_completed: 2

# ============================================================================
# EXTRACTION STATE
# ============================================================================
# Tracks state between /buildforce.extract invocations.
# Enables continuation after /clear or session restart.

extraction:
  needs_clarification:
    - "Should the migration system (MigrationRunner) be documented as a separate context item?"
    - "Are there plans to add automated testing? Should we document target test framework preferences?"
    - "Should linting tools (ESLint/Prettier) be added to the quality gates?"
  recommended_focus:
    - id: build-command
      reason: "Core workflow command - could benefit from moderate depth with extension points"
    - id: plan-command
      reason: "Core workflow command - could benefit from moderate depth with state flow details"
    - id: complete-command
      reason: "Core workflow command - could benefit from moderate depth with context creation details"
  new_discoveries:
    - id: migration-runner
      domain: architecture
      description: "Database-migration-inspired system for context schema upgrades (MigrationRunner class)"
      priority: medium
    - id: step-tracker
      domain: architecture
      description: "Visual progress tracking class for hierarchical step display"
      priority: low
    - id: commit-conventions
      domain: conventions
      description: "Commitlint configuration with Husky hooks enforcing conventional commits"
      priority: medium
    - id: release-automation
      domain: architecture
      description: "Sophisticated release automation with version calculation and npm publishing"
      priority: low
