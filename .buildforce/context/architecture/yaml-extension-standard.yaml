id: yaml-extension-standard
name: "YAML Extension Standardization"
type: structural
status: production
created: "2025-11-03"
last_updated: "2026-01-26"

summary: |
  Codebase-wide standard requiring all YAML files to use .yaml extension exclusively,
  eliminating .yaml/.yaml inconsistency that caused file-not-found errors for AI agents.
  This pattern affects templates, command references, documentation, and context system files.

responsibilities:
  - Enforce single .yaml extension standard across all YAML files in the codebase
  - Ensure command templates reference .yaml files consistently
  - Maintain git history through git mv operations during file renames
  - Document .yaml requirement in context index and schema files
  - Prevent future .yaml file introduction through documentation and conventions

dependencies:
  internal:
    - cli-architecture: "Template distribution system must use .yaml files"
    - command-templates: "All slash commands reference .yaml files for spec/plan/research/context"
    - context-system: "Context index and schema enforce .yaml extension"
  external:
    - git: "Used for history-preserving file renames via git mv"

files:
  primary:
    - src/templates/research-template.yaml
    - src/templates/spec-template.yaml
    - src/templates/plan-template.yaml
    - src/context/_index.yaml
    - src/context/_schema.yaml
    - src/context/_graph.yaml
  secondary:
    - src/templates/commands/build.md
    - src/templates/commands/complete.md
    - src/templates/commands/plan.md
    - src/templates/commands/research.md
    - src/templates/commands/document.md
    - README.md

design_decisions:
  - decision: "Use .yaml as the single standard extension"
    rationale: |
      More explicit than .yaml, matches existing spec/plan templates, aligns with modern
      industry trend toward official .yaml extension, eliminates all ambiguity.

  - decision: "No backward compatibility for .yaml"
    rationale: |
      Clean break eliminates ongoing maintenance burden, forces complete migration,
      prevents future confusion. Since no external users exist yet, breaking change
      impact is limited to buildforce-cli repo itself.

  - decision: "Two-phase migration (source â†’ instances)"
    rationale: |
      Separates breaking changes in source templates from instance migrations,
      allows testing between phases, provides clear rollback points.

  - decision: "Git mv for all renames"
    rationale: |
      Preserves file history, maintains blame/log tracking, avoids confusion in
      git history. Essential for understanding file evolution.

evolution:
  - version: "1.0"
    date: "2025-11-03"
    changes: |
      Initial standardization completed. Renamed 4 source template files (research-template,
      _index, _schema, _graph) from .yaml to .yaml. Updated 40+ references across 7 files
      (5 command templates + README + research-template). Migrated 15 .buildforce instance
      files (3 system files + 12 context files). All grep validations passing - zero .yaml
      extensions remain in src/ or .buildforce/ directories.

related_specs:
  - standardize-yaml-extensions-20251103000000

notes: |
  This standardization was necessary because mixed .yaml/.yaml usage caused file-not-found
  errors when AI agents attempted to read workflow files. The inconsistency was introduced
  gradually rather than systematically - bash/PowerShell scripts already used .yaml correctly.

  Migration completed in 6 phases:
  - Phase 1: Renamed 4 source template files
  - Phase 2: Updated 5 command template references (40+ refs)
  - Phase 3: Updated documentation (README, template self-refs, index docs)
  - Phase 4: Build validation and grep tests
  - Phase 5: Migrated 15 .buildforce instance files
  - Phase 6: Final validation - zero .yaml extensions remain

  Future consideration: Add pre-commit hook or linter rule to prevent .yaml files from
  being committed to src/ directory.

  Breaking change: Affects any existing .buildforce directories using old .yaml extensions,
  but since no external users exist yet, impact limited to local development.
