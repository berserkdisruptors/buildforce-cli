id: examples-command
name: Examples Command
type: feature
status: production
created: 2025-11-01
last_updated: 2025-11-01

summary: |
  Interactive CLI command (`buildforce examples`) that presents workflow examples from README.md.
  Displays an interactive menu with 6 workflows (Basic, Full, Documentation, Context Centering,
  Contribute to Existing Spec, Research During Build) using arrow-key selection. Extracts workflow
  details dynamically from README.md to maintain single source of truth. Supports viewing multiple
  workflows in a session with back/exit navigation. Uses consistent styling with CLI help output
  (white for titles/banner, mint color for options/labels).

responsibilities:
  - Present interactive menu with 6 predefined workflows using arrow-key selection
  - Extract workflow details dynamically from README.md file
  - Display selected workflow with command sequence, description, and use case
  - Allow users to view multiple workflows in a single session (back/exit navigation)
  - Handle missing README.md gracefully with clear error messages
  - Use consistent formatting with existing CLI commands (boxed sections, color scheme)
  - Promote discoverability via message in CLI help output
  - Properly release terminal/stdin after completion

dependencies:
  internal:
    - cli-architecture: "Command registration follows existing pattern in src/cli.ts"
    - formatting-utilities: "Uses lib/interactive.ts for selectWithArrows and showBanner, boxSection formatting from cli.ts"
  external:
    - commander: "^12.0.0 - CLI argument parsing for command registration"
    - fs-extra: "^11.2.0 - File operations for reading README.md"
    - inquirer: "^9.2.15 - Interactive prompt selection with arrow keys"
    - chalk: "^5.3.0 - Terminal output coloring for consistent styling"

files:
  primary:
    - src/commands/examples.ts
  secondary:
    - src/cli.ts
    - src/lib/interactive.ts
    - src/constants.ts
    - README.md

interfaces:
  exports:
    - name: "buildforce examples"
      signature: "CLI command (no arguments, interactive by default)"
      description: "Displays interactive menu of workflow examples extracted from README.md"

command_signature:
  syntax: "buildforce examples"
  arguments: []
  examples:
    - "buildforce examples"

design_decisions:
  - decision: "Parse README.md dynamically instead of maintaining separate data structure"
    rationale: "Single source of truth principle - examples live in README.md, command extracts on-demand. This prevents drift between documentation and CLI output."

  - decision: "Use string parsing with regex/line matching instead of markdown parser"
    rationale: "README.md structure is well-defined and relatively simple. Lightweight parsing avoids adding markdown parser dependency and keeps implementation simple."

  - decision: "Reuse existing formatting utilities from lib/interactive.ts and cli.ts"
    rationale: "Consistency with existing CLI output styling. Reduces code duplication and maintains visual consistency across commands (white titles/banner, mint options/labels)."

  - decision: "Hardcode 6 workflow IDs and extract descriptions from README.md"
    rationale: "Workflow IDs are stable identifiers (basic, full, documentation, context-centering, contribute-existing, research-during-build). Descriptions are extracted from README.md to keep them up-to-date with documentation."

  - decision: "Use interactive loop with back/exit options instead of single-view"
    rationale: "Enables users to explore multiple workflows in one session without restarting the command. Improves discoverability and user experience."

  - decision: "Explicit process.exit(0) when user selects exit"
    rationale: "Ensures Node.js process terminates cleanly and releases terminal back to shell. Prevents hanging terminal state after command completion."

  - decision: "Add discoverability message in CLI help output"
    rationale: "Promotes the examples command to users who might not know it exists. Helps users discover workflow patterns and improves overall UX."

workflows_supported:
  - id: "basic"
    name: "Basic"
    description: "Simple workflow for straightforward features"
    command_sequence: ["/plan", "/build", "/complete"]
  
  - id: "full"
    name: "Full"
    description: "Complete workflow with research for complex features"
    command_sequence: ["/research", "/plan", "/build", "/complete"]
  
  - id: "documentation"
    name: "Documentation"
    description: "Workflow focused on documentation generation"
    command_sequence: ["/plan", "/build", "/document"]

architecture_flow: |
  Examples Command Flow:

  1. Command Invocation (cli.ts):
     - User runs `buildforce examples`
     - Command registered in cli.ts with no arguments
     - Calls examplesCommand() handler

  2. Initialization (examples.ts):
     - Display banner using showBanner() from lib/interactive.ts
     - Check if terminal is interactive (process.stdin.isTTY)
     - If non-interactive, display error and exit

  3. README.md Parsing (examples.ts):
     - Read README.md from project root using fs-extra
     - Parse workflow descriptions using regex patterns
     - Extract descriptions for workflows from specific sections:
       * Lines 56-70: Hello Buildforce (Basic workflow)
       * Lines 102-120: Three workflow scenarios (Full, Documentation)
     - Handle missing README.md gracefully with error message

  4. Workflow Selection Loop (examples.ts):
     - Merge hardcoded workflow definitions with extracted descriptions
     - Display interactive menu using selectWithArrows()
     - User selects workflow using arrow keys
     - Display selected workflow using displayWorkflow() with boxSection formatting

  5. Continue/Exit Prompt (examples.ts):
     - After displaying workflow, prompt user with options:
       * "View another workflow" (back)
       * "Exit"
     - If "back": Loop continues, show workflow selection again
     - If "exit": Call process.exit(0) to terminate Node.js process cleanly

  6. Output Formatting (examples.ts):
     - Use boxSection() utility (duplicated from cli.ts) for consistent boxed output
     - Title uses white color (chalk.bold.white) matching CLI help
     - Section labels (Command Sequence, Description, When to Use) use mint color
     - Banner uses white color consistently via showBanner()
     - Interactive options use mint color via selectWithArrows()

  7. Terminal Cleanup (examples.ts):
     - Add blank row before exit for visual separation
     - Call process.exit(0) when user selects exit
     - Ensures terminal returns to shell prompt cleanly

implementation_phases:
  phase_1:
    name: "Command Registration and Structure"
    tasks:
      - "Create src/commands/examples.ts with examplesCommand() handler"
      - "Register examples command in src/cli.ts with Commander"
      - "Define hardcoded workflow structures (6 workflows)"
    validation: "Running buildforce examples --help shows command documentation"

  phase_2:
    name: "README.md Parsing and Workflow Extraction"
    tasks:
      - "Implement readReadme() function with error handling"
      - "Implement extractWorkflowDescriptions() with regex parsing"
      - "Merge hardcoded workflows with extracted descriptions"
      - "Add default descriptions for workflows not found in README"
    validation: "Command successfully extracts workflow details from README.md"

  phase_3:
    name: "Interactive Display and Formatting"
    tasks:
      - "Implement displayWorkflow() using boxSection formatting"
      - "Fix boxSection title color to white (chalk.bold.white)"
      - "Fix banner to use white consistently (showBanner in lib/interactive.ts)"
      - "Fix interactive menu options to mint color (selectWithArrows)"
      - "Ensure section labels use mint color correctly"
    validation: "Output formatting matches CLI help output styling"

  phase_4:
    name: "Error Handling and Performance"
    tasks:
      - "Add TTY check for non-interactive environments"
      - "Add graceful error handling for missing README.md"
      - "Optimize regex parsing for performance"
    validation: "Command handles edge cases gracefully"

  phase_5:
    name: "UX Enhancements"
    tasks:
      - "Add back button functionality with workflow loop"
      - "Add discoverability message in CLI help output"
      - "Fix tagline color in showBanner to mint"
      - "Add blank row below workflow display"
      - "Ensure proper terminal cleanup with process.exit(0)"
    validation: "Users can view multiple workflows and exit cleanly"

key_features:
  discoverability:
    - "Promoted in CLI help output with message below tagline"
    - "Easy access to workflow examples without opening README.md"
    - "Interactive menu makes workflows easy to explore"

  consistency:
    - "Uses same styling as CLI help output (white titles, mint options)"
    - "Reuses existing formatting utilities for consistency"
    - "Matches interactive patterns from other commands"

  maintainability:
    - "Single source of truth: README.md is the authoritative source"
    - "Workflow descriptions stay in sync with documentation"
    - "No duplicate data structures to maintain"

  user_experience:
    - "View multiple workflows in one session"
    - "Back/exit navigation for easy exploration"
    - "Clean terminal release after completion"
    - "Graceful handling of missing README.md"

edge_cases_handled:
  - "Missing README.md → Clear error message directing user to project root"
  - "Non-interactive terminal → Display error and exit gracefully"
  - "Workflow not found in README.md → Use default description"
  - "Terminal hanging after exit → Explicit process.exit(0) ensures clean termination"
  - "Invalid workflow selection → Error handling prevents crashes"

evolution:
  - version: "1.0"
    date: "2025-11-01"
    changes: |
      Initial implementation with:
      - Interactive menu with 6 workflows
      - README.md dynamic parsing
      - Back/exit navigation
      - Consistent styling (white titles, mint options)
      - Discoverability message in CLI help
      - Proper terminal cleanup with process.exit(0)

related_specs:
  - add-examples-command-20251030215737

notes: |
  The examples command serves as an interactive reference guide for Buildforce workflows.
  It makes the CLI more approachable for new users and serves as a reminder for experienced users.

  Key design trade-offs:
  - Simplicity over flexibility: No caching or export options, just direct display
  - Consistency over customization: Uses existing formatting utilities
  - Single source of truth: README.md is authoritative, no duplicate data structures

  Future enhancements could include:
  - Caching parsed examples for performance
  - Exporting examples to JSON/YAML formats
  - Non-interactive mode with command-line arguments
  - Validating README.md structure and suggesting fixes

