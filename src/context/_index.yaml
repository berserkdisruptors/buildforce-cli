# Buildforce Context Repository Index & Coverage Map
# This file serves as both the context index AND the context coverage map.
# Version 2.1: Unified structure with domain items tracking for /buildforce.extract

version: "2.1"

# ============================================================================
# CONTEXT TAXONOMY OVERVIEW
# ============================================================================
#
# The context repository is organized into three domains, each aligned with
# the context taxonomy pillars that AI agents need most:
#
# 1. ARCHITECTURE (architecture/)
#    Answers: WHAT exists already?
#    Contains: Structural understanding of modules, features, components, and their relationships
#    Used by: /buildforce.research, /buildforce.plan, /buildforce.build
#
# 2. CONVENTIONS (conventions/)
#    Answers: HOW do we do things here?
#    Contains: Coding standards, patterns, and practices
#    Used by: /buildforce.plan, /buildforce.build (validation)
#
# 3. VERIFICATION (verification/)
#    Answers: HOW do I know it's right?
#    Contains: Quality standards, test expectations, known risks
#    Used by: /buildforce.build (self-review), PR Review Actions
#
# For more details on the context taxonomy, see:
# https://buildforce.dev/concepts/context-taxonomy
#
# ============================================================================
# VERSION 2.1: COVERAGE MAP FUNCTIONALITY
# ============================================================================
#
# In v2.1, this file also serves as a coverage map for /buildforce.extract.
# Each domain tracks:
#   - items[]: Discovered and extracted context items with status/depth
#   - coverage: Percentage of items that have been extracted
#   - average_depth: Overall extraction depth (none|shallow|moderate|deep)
#
# Item structure:
#   - id: unique-item-id
#   - file: path/to/context-file.yaml
#   - type: structural|convention|verification
#   - description: Brief description of the item
#   - tags: [optional, categorization, tags]
#   - related_context: [references-to-other-items]
#   - status: discovered | in-progress | extracted
#   - depth: none | shallow | moderate | deep
#
# The /buildforce.extract command uses this coverage map to:
#   1. Track what has been discovered in the codebase
#   2. Track what has been extracted and to what depth
#   3. Recommend focus areas for subsequent extraction iterations
#
# ============================================================================

# Timestamps (populated by /buildforce.extract on first run)
generated_at: null
last_updated: null

# ============================================================================
# CODEBASE PROFILE
# ============================================================================
# Populated by /buildforce.extract during initial codebase scan.
# Provides high-level overview of the project for AI agents.

codebase_profile:
  languages: []           # e.g., [typescript, python]
  frameworks: []          # e.g., [express, react, fastapi]
  project_type: null      # e.g., "full-stack monorepo", "cli tool", "library"
  scale: null             # e.g., "small (~5k LOC)", "medium (~45k LOC)"

# ============================================================================
# CONTEXT DOMAINS
# ============================================================================
# Each domain tracks both schema reference AND extracted items.
# Items are discovered during codebase scan and populated during extraction.

domains:
  structural:
    description: |
      Structural context about WHAT exists in the codebase.
      Contains understanding of modules, features, components, and their relationships.
    schema: architecture/_schema.yaml
    coverage: 0
    average_depth: none
    items: []

  conventions:
    description: |
      Convention context about HOW things are done here.
      Contains coding standards, architectural patterns, and project practices.
    schema: conventions/_schema.yaml
    coverage: 0
    average_depth: none
    items: []
    # Convention items also include: sub_type, enforcement

  verification:
    description: |
      Verification context about HOW to know if code is right.
      Contains quality standards, test expectations, review checklists, and known risks.
    schema: verification/_schema.yaml
    coverage: 0
    average_depth: none
    items: []
    # Verification items also include: source (mined | manual | hybrid)

# ============================================================================
# AGGREGATE SUMMARY
# ============================================================================
# Computed metrics across all domains. Updated after each extraction iteration.

summary:
  overall_coverage: 0
  total_items: 0
  extracted_items: 0
  iterations_completed: 0

# ============================================================================
# EXTRACTION STATE
# ============================================================================
# Tracks state between /buildforce.extract invocations.
# Enables continuation after /clear or session restart.

extraction:
  needs_clarification: []    # Questions that emerged during extraction
  recommended_focus: []      # Suggested items for next iteration
  # Format: - id: item-id
  #           reason: "Why this item should be prioritized"
  new_discoveries: []        # Items found but not yet in items arrays
